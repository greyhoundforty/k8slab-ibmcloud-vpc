# Kube-Worker Role

This role configures Kubernetes worker nodes to join the cluster.

## Purpose

The kube-worker role allows worker nodes to join the Kubernetes cluster by using the join command generated by the controller. It's designed to run after the kube-controller role has initialized the control plane.

## Tasks Performed

1. **Cluster Status Check**:
   - Checks if the node is already joined to the cluster
   - Retrieves the join command from the first controller node

2. **Cluster Join Operation**:
   - Joins the worker node to the cluster using the kubeadm join command
   - Only runs the join operation if the node is not already part of the cluster

3. **Node Status Verification**:
   - Waits for the node to be in a Ready state
   - Verifies that the join operation was successful

## Requirements

- The kube-base role must be run first to set up containerd and Kubernetes components
- The kube-controller role must be run first to initialize the cluster
- Network connectivity between worker nodes and controller nodes

## Dependencies

- Depends on the `common` and `kube-base` roles
- Requires the `kubeadm_join_cmd` variable from the kube-controller role

## Notes

- The role is idempotent and will not attempt to join a node that is already part of the cluster
- It automatically retrieves the join command from the first controller node
- Worker nodes can be added to the cluster at any time (even after the initial deployment)
- Waits for the node to reach a Ready state before considering the task complete

## Variables Used

- `hostvars[groups['controllers'][0]]['kubeadm_join_cmd']`: The join command generated by the first controller node
